<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Recommendations - Silver Spoon Society</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="password-protection.js"></script>
</head>
<body>
    <!-- Navigation Bar Trigger -->
    <div class="navbar-trigger"></div>
    
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="home.html" class="nav-logo">
                <div class="logo-icon">
                    <!-- Logo image -->
                    <img src="SliverSpoonSociety_Logo.jpg" alt="Silver Spoon Society Logo" class="custom-logo">
                </div>
                <div class="logo-text">
                    <h1>Silver Spoon Society</h1>
                </div>
            </a>
            <div class="nav-links">
                <a href="home.html" class="nav-link">
                    <i class="fas fa-home"></i>
                    <span>Home</span>
                </a>
                <a href="explore-recipes.html" class="nav-link">
                    <i class="fas fa-search"></i>
                    <span>Recipes</span>
                </a>
                <a href="seasonal-produce.html" class="nav-link">
                    <i class="fas fa-leaf"></i>
                    <span>Seasonal</span>
                </a>
                <a href="meal-planning.html" class="nav-link">
                    <i class="fas fa-calendar-alt"></i>
                    <span>Planning</span>
                </a>
                <a href="shopping-list.html" class="nav-link">
                    <i class="fas fa-shopping-cart"></i>
                    <span>Shopping</span>
                </a>
                <a href="nutrition-dashboard.html" class="nav-link">
                    <i class="fas fa-chart-line"></i>
                    <span>Dashboard</span>
                </a>
                <a href="daily-recommendations.html" class="nav-link active">
                    <i class="fas fa-heart"></i>
                    <span>Daily Tips</span>
                </a>
            </div>
            
            <!--
            <div class="nav-right">
                <button class="nav-icon-btn">
                    <i class="fas fa-globe"></i>
                </button>
                <button class="nav-icon-btn">
                    <i class="fas fa-ellipsis-v"></i>
                </button>
            </div>
            -->

            <button class="mobile-menu-btn">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </nav>
    <main class="main-content">
        <!-- Page Header -->
        <section class="page-header">
            <div class="section-container">
                <h1 class="page-title"><i class="fas fa-heart"></i> Daily Health Tips</h1>
                <p class="page-subtitle">Personalized nutrition and wellness recommendations for healthy aging</p>
                <p class="page-description">Get expert advice on maintaining optimal health through smart food choices and lifestyle habits</p>
            </div>
        </section>

        <!-- Today's Featured Tip -->
        <section class="featured-tip-section">
            <div class="section-container">
                <div class="featured-tip-card">
                    <div class="tip-icon">
                        <i class="fas fa-star"></i>
                    </div>
                    <div class="tip-content">
                        <h2>Today's Featured Tip</h2>
                        <h3>Stay Hydrated for Better Energy</h3>
                        <p>Drink a glass of water first thing in the morning to kickstart your metabolism. Proper hydration helps maintain energy levels, supports digestion, and keeps your skin healthy. Aim for 8-10 glasses throughout the day.</p>
                        <div class="tip-action">
                            <button class="btn btn-primary tip-btn">
                                <i class="fas fa-tint"></i>
                                Track Water Intake
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Personalized Daily Tips -->
        <section id="daily-tips" aria-label="Daily Health Tips">
            <div class="section-container">
                <div class="tips-loading" role="status">
                    <span class="tips-loading-text">Loading personalized tips…</span>
                </div>
            </div>
        </section>

        <!-- Daily Recommendations Grid -->
        <section class="recommendations-section">
            <div class="section-container">
                <div class="section-title-wrapper">
                    <h2 class="section-title">Today's Wellness Focus</h2>
                    <p class="section-subtitle">Evidence-based tips tailored for seniors</p>
                </div>
                
                <div class="recommendations-grid">
                    <!-- Nutrition Recommendation -->
                    <div class="recommendation-card">
                        <div class="card-header">
                            <div class="card-icon nutrition-icon">
                                <i class="fas fa-apple-alt"></i>
                            </div>
                            <div class="card-category">Nutrition</div>
                        </div>
                        <h3 class="card-title">Power Up with Protein</h3>
                        <p class="card-description">Include lean protein in every meal to maintain muscle mass and strength. Great options include fish, eggs, beans, and Greek yogurt.</p>
                        <div class="card-stats">
                            <div class="stat">
                                <span class="stat-number">25-30g</span>
                                <span class="stat-label">per meal</span>
                            </div>
                        </div>
                        <div class="card-action">
                            <a href="explore-recipes.html" class="action-link">Find Protein Recipes</a>
                        </div>
                    </div>

                    <!-- Exercise Recommendation -->
                    <div class="recommendation-card">
                        <div class="card-header">
                            <div class="card-icon exercise-icon">
                                <i class="fas fa-walking"></i>
                            </div>
                            <div class="card-category">Exercise</div>
                        </div>
                        <h3 class="card-title">Daily Movement Goal</h3>
                        <p class="card-description">Gentle exercise like walking improves cardiovascular health, bone density, and mental well-being. Start with what feels comfortable.</p>
                        <div class="card-stats">
                            <div class="stat">
                                <span class="stat-number">30 min</span>
                                <span class="stat-label">recommended</span>
                            </div>
                        </div>
                        <div class="card-action">
                            <a href="#" class="action-link">View Exercise Tips</a>
                        </div>
                    </div>

                    <!-- Hydration Recommendation -->
                    <div class="recommendation-card">
                        <div class="card-header">
                            <div class="card-icon hydration-icon">
                                <i class="fas fa-tint"></i>
                            </div>
                            <div class="card-category">Hydration</div>
                        </div>
                        <h3 class="card-title">Smart Hydration</h3>
                        <p class="card-description">Proper hydration supports kidney function, regulates body temperature, and helps prevent constipation. Add lemon for extra flavor!</p>
                        <div class="card-stats">
                            <div class="stat">
                                <span class="stat-number">8-10</span>
                                <span class="stat-label">glasses/day</span>
                            </div>
                        </div>
                        <div class="card-action">
                            <a href="#" class="action-link">Hydration Tracker</a>
                        </div>
                    </div>

                    <!-- Sleep Recommendation -->
                    <div class="recommendation-card">
                        <div class="card-header">
                            <div class="card-icon sleep-icon">
                                <i class="fas fa-moon"></i>
                            </div>
                            <div class="card-category">Sleep</div>
                        </div>
                        <h3 class="card-title">Quality Sleep</h3>
                        <p class="card-description">Good sleep supports immune function, memory, and emotional well-being. Maintain a consistent bedtime routine for better rest.</p>
                        <div class="card-stats">
                            <div class="stat">
                                <span class="stat-number">7-9</span>
                                <span class="stat-label">hours ideal</span>
                            </div>
                        </div>
                        <div class="card-action">
                            <a href="#" class="action-link">Sleep Better Tips</a>
                        </div>
                    </div>

                    <!-- Mental Health Recommendation -->
                    <div class="recommendation-card">
                        <div class="card-header">
                            <div class="card-icon mental-icon">
                                <i class="fas fa-brain"></i>
                            </div>
                            <div class="card-category">Mental Health</div>
                        </div>
                        <h3 class="card-title">Stay Social & Engaged</h3>
                        <p class="card-description">Social connections and mental stimulation are vital for cognitive health. Try cooking with friends or learning new recipes!</p>
                        <div class="card-stats">
                            <div class="stat">
                                <span class="stat-number">Daily</span>
                                <span class="stat-label">interaction</span>
                            </div>
                        </div>
                        <div class="card-action">
                            <a href="meal-planning.html" class="action-link">Plan Social Meals</a>
                        </div>
                    </div>

                    <!-- Preventive Care Recommendation -->
                    <div class="recommendation-card">
                        <div class="card-header">
                            <div class="card-icon health-icon">
                                <i class="fas fa-heart"></i>
                            </div>
                            <div class="card-category">Preventive Care</div>
                        </div>
                        <h3 class="card-title">Heart-Healthy Choices</h3>
                        <p class="card-description">Choose foods rich in omega-3 fatty acids, fiber, and antioxidants. Limit sodium and processed foods for optimal heart health.</p>
                        <div class="card-stats">
                            <div class="stat">
                                <span class="stat-number">5-9</span>
                                <span class="stat-label">fruits/veg daily</span>
                            </div>
                        </div>
                        <div class="card-action">
                            <a href="nutrition-dashboard.html" class="action-link">Track Nutrition</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Weekly Focus Section -->
        <section class="weekly-focus-section">
            <div class="section-container">
                <div class="weekly-focus-card">
                    <div class="focus-header">
                        <h2>This Week's Focus: Bone Health</h2>
                        <div class="focus-badge">Week 3 of 4</div>
                    </div>
                    <div class="focus-content">
                        <div class="focus-description">
                            <p>Strong bones are essential for maintaining independence and preventing fractures. This week, we're focusing on calcium-rich foods and vitamin D.</p>
                        </div>
                        <div class="focus-goals">
                            <div class="goal-item">
                                <i class="fas fa-check-circle"></i>
                                <span>Include 3 servings of dairy or fortified alternatives daily</span>
                            </div>
                            <div class="goal-item">
                                <i class="fas fa-check-circle"></i>
                                <span>Spend 15 minutes in sunlight for vitamin D</span>
                            </div>
                            <div class="goal-item">
                                <i class="fas fa-check-circle"></i>
                                <span>Try weight-bearing exercises like walking</span>
                            </div>
                        </div>
                        <div class="focus-action">
                            <button class="btn btn-secondary">
                                <i class="fas fa-bone"></i>
                                View Bone Health Recipes
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Health News Section -->
        <section class="health-news-section">
            <div class="section-container">
                <div class="section-title-wrapper">
                    <h2 class="section-title">Latest Health News</h2>
                    <p class="section-subtitle">Stay informed with the latest nutrition and wellness research</p>
                </div>
                
                <div class="news-grid">
                    <div class="news-card">
                        <div class="news-image">
                            <i class="fas fa-heartbeat"></i>
                        </div>
                        <div class="news-content">
                            <div class="news-category">Cardiovascular Health</div>
                            <h3 class="news-title">New Study Shows Mediterranean Diet Reduces Heart Disease Risk</h3>
                            <p class="news-summary">Recent research confirms that following a Mediterranean diet pattern can significantly reduce cardiovascular disease risk in older adults.</p>
                            <div class="news-meta">
                                <span class="news-date">October 3, 2024</span>
                                <span class="news-source">Mayo Clinic</span>
                            </div>
                            <a href="https://www.mayoclinic.org/healthy-lifestyle/nutrition-and-healthy-eating/in-depth/mediterranean-diet/art-20047801" target="_blank" class="news-link">
                                <i class="fas fa-external-link-alt"></i>
                                Read Full Article
                            </a>
                        </div>
                    </div>

                    <div class="news-card">
                        <div class="news-image">
                            <i class="fas fa-brain"></i>
                        </div>
                        <div class="news-content">
                            <div class="news-category">Brain Health</div>
                            <h3 class="news-title">Omega-3 Fatty Acids Linked to Better Cognitive Function</h3>
                            <p class="news-summary">A comprehensive study reveals that regular consumption of omega-3 rich foods may help maintain cognitive abilities as we age.</p>
                            <div class="news-meta">
                                <span class="news-date">October 1, 2024</span>
                                <span class="news-source">Mayo Clinic</span>
                            </div>
                            <a href="https://www.mayoclinic.org/drugs-supplements-fish-oil/art-20364810" target="_blank" class="news-link">
                                <i class="fas fa-external-link-alt"></i>
                                Read Full Article
                            </a>
                        </div>
                    </div>

                    <div class="news-card">
                        <div class="news-image">
                            <i class="fas fa-bone"></i>
                        </div>
                        <div class="news-content">
                            <div class="news-category">Bone Health</div>
                            <h3 class="news-title">Vitamin D and Calcium: Essential for Senior Bone Strength</h3>
                            <p class="news-summary">New guidelines emphasize the importance of adequate vitamin D and calcium intake for preventing osteoporosis in older adults.</p>
                            <div class="news-meta">
                                <span class="news-date">September 28, 2024</span>
                                <span class="news-source">Mayo Clinic</span>
                            </div>
                            <a href="https://www.mayoclinic.org/healthy-lifestyle/adult-health/in-depth/bone-health/art-20045060" target="_blank" class="news-link">
                                <i class="fas fa-external-link-alt"></i>
                                Read Full Article
                            </a>
                        </div>
                    </div>

                    <div class="news-card">
                        <div class="news-image">
                            <i class="fas fa-leaf"></i>
                        </div>
                        <div class="news-content">
                            <div class="news-category">Nutrition</div>
                            <h3 class="news-title">Plant-Based Proteins Show Benefits for Aging Muscles</h3>
                            <p class="news-summary">Research suggests that incorporating more plant-based proteins can help maintain muscle mass and strength in seniors.</p>
                            <div class="news-meta">
                                <span class="news-date">September 25, 2024</span>
                                <span class="news-source">Mayo Clinic</span>
                            </div>
                            <a href="https://www.mayoclinic.org/healthy-lifestyle/nutrition-and-healthy-eating/basics/nutrition-basics/hlv-20049477" target="_blank" class="news-link">
                                <i class="fas fa-external-link-alt"></i>
                                Read Full Article
                            </a>
                        </div>
                    </div>

                    <div class="news-card">
                        <div class="news-image">
                            <i class="fas fa-moon"></i>
                        </div>
                        <div class="news-content">
                            <div class="news-category">Sleep Health</div>
                            <h3 class="news-title">Sleep Quality Improves with Evening Meal Timing</h3>
                            <p class="news-summary">A new study finds that eating dinner earlier and avoiding late-night snacks can significantly improve sleep quality in older adults.</p>
                            <div class="news-meta">
                                <span class="news-date">September 22, 2024</span>
                                <span class="news-source">Mayo Clinic</span>
                            </div>
                            <a href="https://diet.mayoclinic.org/us/blog/2022/healthy-habits-for-a-better-night-s-sleep/" target="_blank" class="news-link">
                                <i class="fas fa-external-link-alt"></i>
                                Read Full Article
                            </a>
                        </div>
                    </div>

                    <div class="news-card">
                        <div class="news-image">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="news-content">
                            <div class="news-category">Social Health</div>
                            <h3 class="news-title">Social Dining Enhances Nutritional Intake</h3>
                            <p class="news-summary">Research confirms that eating meals with others leads to better nutrition choices and improved overall health outcomes.</p>
                            <div class="news-meta">
                                <span class="news-date">September 20, 2024</span>
                                <span class="news-source">ScienceDirect</span>
                            </div>
                            <a href="https://www.sciencedirect.com/science/article/pii/S019566632400388X" target="_blank" class="news-link">
                                <i class="fas fa-external-link-alt"></i>
                                Read Full Article
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Quick Tips Section -->
        <section class="quick-tips-section">
            <div class="section-container">
                <h2 class="section-title">Quick Daily Reminders</h2>
                <div class="tips-grid">
                    <div class="tip-item">
                        <div class="tip-icon-small">
                            <i class="fas fa-utensils"></i>
                        </div>
                        <div class="tip-text">
                            <strong>Meal Timing:</strong> Eat regular meals to maintain steady energy levels
                        </div>
                    </div>
                    <div class="tip-item">
                        <div class="tip-icon-small">
                            <i class="fas fa-pills"></i>
                        </div>
                        <div class="tip-text">
                            <strong>Supplements:</strong> Take medications with food to improve absorption
                        </div>
                    </div>
                    <div class="tip-item">
                        <div class="tip-icon-small">
                            <i class="fas fa-thermometer-half"></i>
                        </div>
                        <div class="tip-text">
                            <strong>Food Safety:</strong> Check expiration dates and store perishables properly
                        </div>
                    </div>
                    <div class="tip-item">
                        <div class="tip-icon-small">
                            <i class="fas fa-smile"></i>
                        </div>
                        <div class="tip-text">
                            <strong>Enjoyment:</strong> Share meals with others when possible for social connection
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="section-container">
            <div class="footer-content">
                <p class="footer-text">Supporting healthy eating habits for a better life</p>
                <p class="footer-copyright">© 2024 Silver Spoon Society. Designed for senior wellness.</p>
            </div>
        </div>
    </footer>

    <script src="config.js"></script>
    <script src="script.js"></script>
    <script type="module">
        import {
            loadHealthTips,
            getUserProfile,
            filterTips,
            pickDailyTips,
            renderTips,
            getRefreshCounter,
            incrementRefreshCounter,
            resetRefreshCounter
        } from './health-tips.js';

        const tipsSection = document.getElementById('daily-tips');

        async function buildTipsSection(refreshCounterOverride) {
            if (!tipsSection) return;

            tipsSection.innerHTML = `
                <div class="section-container">
                    <div class="tips-loading" role="status">
                        <span class="tips-loading-text">Loading personalized tips…</span>
                    </div>
                </div>
            `;

            try {
                const [allTips, profile] = await Promise.all([
                    loadHealthTips(),
                    Promise.resolve(getUserProfile())
                ]);

                const filtered = filterTips(allTips, profile);
                const usingFallback = allTips.length > 0 && allTips.every(tip => tip._fallback);

                let note;
                let sourceTips = filtered;
                let desiredCount = 4;

                if (filtered.length === 0 && !usingFallback) {
                    const generalTips = allTips.filter(
                        tip => tip.type === 'lifestyle' || String(tip.category || '').toLowerCase() === 'balanced_diet'
                    );
                    note = 'No personalized tips found. Showing general tips.';
                    sourceTips = generalTips.length ? generalTips : allTips;
                    desiredCount = Math.min(3, Math.max(2, sourceTips.length));
                } else if (usingFallback) {
                    note = 'Unable to load personalized tips. Showing a default reminder.';
                    sourceTips = allTips;
                    desiredCount = Math.min(2, sourceTips.length);
                }

                if (!sourceTips.length) {
                    sourceTips = allTips;
                }

                const refreshCounter = Number.isFinite(refreshCounterOverride)
                    ? refreshCounterOverride
                    : getRefreshCounter();

                const picked = pickDailyTips(sourceTips, desiredCount, profile, refreshCounter);
                renderTips(picked, tipsSection, {
                    title: 'Personalized Daily Tips',
                    subtitle: 'Tailored suggestions based on your questionnaire responses',
                    note,
                    refreshable: true
                });

                attachRefreshHandler(profile);
            } catch (error) {
                console.error('[daily-tips] Failed to initialize tips:', error);
                renderTips([], tipsSection, {
                    title: 'Personalized Daily Tips',
                    subtitle: 'Tailored suggestions based on your questionnaire responses',
                    note: 'Tips are temporarily unavailable. Please try again later.'
                });
            }
        }

        function attachRefreshHandler(profile) {
            const refreshBtn = tipsSection.querySelector('.tips-refresh-btn');
            if (!refreshBtn) return;

            refreshBtn.addEventListener('click', () => {
                refreshBtn.disabled = true;
                const counter = incrementRefreshCounter();
                buildTipsSection(counter).finally(() => {
                    refreshBtn.disabled = false;
                });
            });
        }

        if (tipsSection) {
            const currentDate = dateKey();
            const storedDate = sessionStorage.getItem('dailyTipsDate');
            if (storedDate !== currentDate) {
                resetRefreshCounter();
                sessionStorage.setItem('dailyTipsDate', currentDate);
            }
            buildTipsSection();
        }

        function dateKey() {
            return new Date().toISOString().slice(0, 10);
        }
    </script>
</body>
</html>
